<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>상태 대시보드</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
<section class="section">
<div class="container">
    <h1 class="title">트레이딩 현황</h1>
    <h2 class="subtitle" id="selected_strategy">-</h2>
    <div class="columns is-multiline" id="cards">
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">심리 상태</p>
                <p id="sentiment" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">전략</p>
                <p id="strategy" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">신호</p>
                <p id="signal" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">가격</p>
                <p id="price" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">잔고</p>
                <p id="balance" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">포지션</p>
                <p id="position" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">가중치</p>
                <p id="weight" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">RSI</p>
                <p id="rsi" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">볼린저</p>
                <p id="bb_score" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">체결 강도</p>
                <p id="ts_score" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">가장 근접 실패</p>
                <p id="nearest_failed" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">매수/매도 비율</p>
                <p id="orderbook_ratio" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">수익률</p>
                <p id="return_rate" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">최근 거래</p>
                <p id="last_trade_time" class="title card-value">-</p>
            </div>
        </div>
        <div class="column is-one-third">
            <div class="box has-text-centered">
                <p class="heading">누적 수익</p>
                <p id="cumulative_return" class="title card-value">-</p>
            </div>
        </div>
    </div>
    <div id="weights_chart" style="height:300px;"></div>

    <h3>📊 실시간 수익률 (보유 중)</h3>
    <table class="table is-striped is-fullwidth" id="returnTable">
      <thead>
        <tr><th>포지션</th><th>진입가</th><th>현재가</th><th>수익률</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <div>
      🟢 매수 횟수: <span id="buyCount">0</span>회<br>
      🔴 매도 횟수: <span id="sellCount">0</span>회
      <button onclick="toggleTradeLog()">거래 상세보기</button>
    </div>

    <div id="tradeLog" style="display:none;">
      <h4>📋 거래 내역 (최근)</h4>
      <ul id="tradeList"></ul>
    </div>

    <!-- 실시간 시세 차트 -->
    <h3>📈 실시간 시세</h3>
    <div id="priceChart" style="height:300px;"></div>

    <!-- 직관적 호가창 시각화 -->
    <h3>🏛️ 실시간 호가창 (상/하 10개)</h3>
    <div id="orderbookChart" style="height:500px; margin-bottom: 30px;"></div>
</div>
</section>
<script src="{{ url_for('static', filename='status.js') }}"></script>
</body>
</html>
